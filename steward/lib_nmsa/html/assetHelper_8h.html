<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>NMSAservicewrapperfortheEILLinuxClientAgent: assetHelper.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>assetHelper.h File Reference</h1>  </div>
</div>
<div class="contents">

<p><a href="assetHelper_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="assetHelper_8h.html#a2f478e47bdb3c0393a2d88cecb90b704">ASSET_TIMEOUT</a>&nbsp;&nbsp;&nbsp;8*60</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The asset timeout.  <a href="#a2f478e47bdb3c0393a2d88cecb90b704"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="assetHelper_8h.html#aaf377ff96c6dd58b6d506be475068380">ASSET_INFO_FILE</a>&nbsp;&nbsp;&nbsp;&quot;/opt/intel/assetinfo&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location of the asset info file.  <a href="#aaf377ff96c6dd58b6d506be475068380"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="assetHelper_8h.html#aa47ccde2857031971f74b3d69e15b0da">assetReady</a> (char **assetInfo, StewardLogger *logger, bool ignoreTimeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determines if the asset info is fresh, and ready to be uploaded to CCMS.  <a href="#aa47ccde2857031971f74b3d69e15b0da"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aaf377ff96c6dd58b6d506be475068380"></a><!-- doxytag: member="assetHelper.h::ASSET_INFO_FILE" ref="aaf377ff96c6dd58b6d506be475068380" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSET_INFO_FILE&nbsp;&nbsp;&nbsp;&quot;/opt/intel/assetinfo&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The location of the asset info file. </p>

</div>
</div>
<a class="anchor" id="a2f478e47bdb3c0393a2d88cecb90b704"></a><!-- doxytag: member="assetHelper.h::ASSET_TIMEOUT" ref="a2f478e47bdb3c0393a2d88cecb90b704" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSET_TIMEOUT&nbsp;&nbsp;&nbsp;8*60</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The asset timeout. </p>
<p>This determines how long we should wait before "giving up" on the asset info script after boot and just moving on. It should be in seconds.</p>
<p>The reason we have this timeout is because:</p>
<ul>
<li>The asset collection script may or may not be present on the system. If the script is not present on the system, we do not want to keep probing for the asset info file forever as this is wasteful and a potential security hole.</li>
</ul>
<ul>
<li>There might be a problem with the asset collection script which might require external user diagnostic. If this is the case, there is nothing the Linux client agent can do about it, so, again, we do not want to keep probing for the asset info file.</li>
</ul>
<ul>
<li>Due to the fact that the asset collection script runs <b>after</b> the steward starts up, we have to have some delay to give it a chance to complete. If we simply assumed it was ready, there would exist the potential for a race condition, which would be bad. </li>
</ul>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa47ccde2857031971f74b3d69e15b0da"></a><!-- doxytag: member="assetHelper.h::assetReady" ref="aa47ccde2857031971f74b3d69e15b0da" args="(char **assetInfo, StewardLogger *logger, bool ignoreTimeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int assetReady </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>assetInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StewardLogger *&nbsp;</td>
          <td class="paramname"> <em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>ignoreTimeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determines if the asset info is fresh, and ready to be uploaded to CCMS. </p>
<p>Quite simply, when you call this helper if checks to see if the system has recently booted and if there is a fresh asset info file available for submittal to CCMS. If it is, it returns a true and sets the char assetInfo to the contents of the asset info file.</p>
<p>More specifically, the proper way to use this is to maintain a flag of your own and to call this until it returns "true". Once it returns true, you really should never call it again (though, calling it again certainly will not hurt anything, it simply will be unnecessary).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>assetInfo</em>&nbsp;</td><td>A character array pointer which will hold the asset info </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>logger</em>&nbsp;</td><td>The logger instance (for logging of errors) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignoreTimeout</em>&nbsp;</td><td>whether we should ignore system timeout or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A positive int indicating the size of assetInfo on success. A negative int on failure. Returns 0 if the timeout period has past.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>assetInfo should not be initialized, as it will be initalized by the assetReady(char *assetInfo) function. Additionally, once it has been discharged by the steward service wrapper, it should be free'd (see malloc(3) ) or else there will be a memory leak. </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Mar 8 2011 09:32:41 for NMSAservicewrapperfortheEILLinuxClientAgent by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
